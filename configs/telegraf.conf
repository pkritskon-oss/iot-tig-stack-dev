[agent]
  interval = "10s"
  round_interval = true
  flush_interval = "10s"          # flush ทุก 10 วินาที
  metric_batch_size = 500         # ส่งทีละไม่เกิน 500 metrics
  metric_buffer_limit = 10000     # buffer ได้สูงสุด 10,000 metrics กัน data loss

# MQTT input
[[inputs.mqtt_consumer]]
  servers = ["tcp://mosquitto:1883"]
  topics = ["8E215788_nx100_raw/+/data"]
  data_format = "json"
  name_override = "iot_raw"

# InfluxDB output
[[outputs.influxdb]]
  urls = ["http://influxdb_repo:8086"]
  database = "iotdata"
  timeout = "10s"                 # เพิ่ม timeout จาก default 5s → 10s
  write_consistency = "any"       # เขียนได้แม้ cluster มี node เดียว
